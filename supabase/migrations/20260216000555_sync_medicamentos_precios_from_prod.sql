-- Sync medicamentos.precio from PROD and update all movimientos precio_unitario

-- Step 1: Update medicamentos.precio to match PROD values
UPDATE medicamentos SET precio = v.precio
FROM (VALUES
  ('P002', 298.00),
  ('P005', 255.00),
  ('P006', 267.00),
  ('P008', 448.00),
  ('P009', 466.00),
  ('P014', 244.00),
  ('P015', 298.00),
  ('P016', 409.00),
  ('P017', 353.00),
  ('P019', 362.00),
  ('P021', 258.00),
  ('P022', 250.00),
  ('P023', 251.00),
  ('P024', 548.00),
  ('P025', 363.00),
  ('P027', 267.00),
  ('P028', 473.00),
  ('P029', 288.00),
  ('P030', 273.00),
  ('P031', 298.00),
  ('P032', 267.00),
  ('P033', 336.00),
  ('P034', 480.00),
  ('P035', 232.00),
  ('P036', 205.00),
  ('P038', 366.00),
  ('P040', 284.00),
  ('P041', 204.00),
  ('P043', 241.00),
  ('P044', 254.00),
  ('P045', 233.00),
  ('P046', 233.00),
  ('P047', 229.00),
  ('P048', 226.00),
  ('P050', 298.00),
  ('P051', 219.00),
  ('P052', 270.00),
  ('P053', 250.00),
  ('P054', 193.00),
  ('P055', 192.00),
  ('P057', 397.00),
  ('P058', 377.00),
  ('P060', 287.00),
  ('P061', 238.00),
  ('P062', 267.00),
  ('P063', 205.00),
  ('P064', 211.00),
  ('P065', 214.00),
  ('P066', 248.00),
  ('P067', 1321.00),
  ('P068', 1914.00),
  ('P069', 262.00),
  ('P070', 275.00),
  ('P071', 1146.00),
  ('P072', 250.00),
  ('P073', 325.00),
  ('P074', 288.00),
  ('P076', 504.00),
  ('P077', 238.00),
  ('P078', 286.00),
  ('P079', 275.00),
  ('P080', 280.00),
  ('P081', 331.00),
  ('P082', 295.00),
  ('P083', 325.00),
  ('P084', 247.00),
  ('P085', 270.00),
  ('P086', 336.00),
  ('P087', 278.00),
  ('P089', 369.00),
  ('P090', 327.00),
  ('P092', 222.00),
  ('P094', 359.00),
  ('P095', 269.00),
  ('P096', 298.00),
  ('P098', 2293.00),
  ('P099', 1409.00),
  ('P101', 306.00),
  ('P102', 764.00),
  ('P105', 292.00),
  ('P106', 381.00),
  ('P107', 420.00),
  ('P112', 266.00),
  ('P113', 459.00),
  ('P115', 292.00),
  ('P117', 206.00),
  ('P120', 206.00),
  ('P122', 383.00),
  ('P123', 386.00),
  ('P131', 487.00),
  ('P133', 250.00),
  ('P134', 295.00),
  ('P136', 383.00),
  ('P138', 289.00),
  ('P141', 372.00),
  ('P145', 197.00),
  ('P146', 247.00),
  ('P147', 220.00),
  ('P148', 342.00),
  ('P156', 304.00),
  ('P157', 207.00),
  ('P158', 263.00),
  ('P160', 298.00),
  ('P161', 200.00),
  ('P162', 273.00),
  ('P163', 268.00),
  ('P165', 329.00),
  ('P168', 240.00),
  ('P169', 222.00),
  ('P171', 301.00),
  ('P179', 577.00),
  ('P180', 440.00),
  ('P183', 262.00),
  ('P187', 270.00),
  ('P188', 353.00),
  ('P191', 345.00),
  ('P192', 283.00),
  ('P193', 406.00),
  ('P202', 369.00),
  ('P205', 294.00),
  ('P206', 485.00),
  ('P207', 229.00),
  ('P208', 327.00),
  ('P209', 439.00),
  ('P210', 440.00),
  ('P212', 369.00),
  ('P213', 369.00),
  ('P214', 369.00),
  ('P215', 321.00),
  ('P216', 306.00),
  ('P217', 256.00),
  ('P218', 331.00),
  ('P219', 280.00),
  ('P220', 288.00),
  ('P221', 332.00),
  ('P222', 196.00),
  ('P224', 1166.00),
  ('P225', 343.00),
  ('P226', 429.00),
  ('P228', 244.00),
  ('P229', 219.00),
  ('P230', 288.00),
  ('P231', 288.00),
  ('P232', 288.00),
  ('P233', 322.00),
  ('P234', 872.00),
  ('P235', 321.00),
  ('P248', 351.00),
  ('P249', 2586.00),
  ('P251', 1603.00),
  ('P254', 268.00),
  ('P256', 434.00),
  ('P258', 459.00),
  ('P259', 274.00),
  ('P260', 1798.00),
  ('P261', 1508.00),
  ('P262', 2213.00),
  ('P263', 344.00),
  ('P265', 1318.00),
  ('P267', 1848.00),
  ('P271', 481.00),
  ('P272', 795.00),
  ('P273', 1084.00),
  ('P274', 3497.00),
  ('P275', 561.00),
  ('P278', 909.00),
  ('P280', 370.00),
  ('P282', 2867.00),
  ('P283', 795.00),
  ('P284', 832.00),
  ('P285', 2401.00),
  ('P286', 614.00),
  ('P288', 202.00),
  ('P292', 297.00),
  ('P294', 419.00),
  ('P296', 914.00),
  ('P297', 2357.00),
  ('P298', 1477.00),
  ('P299', 485.00),
  ('P300', 271.00),
  ('P301', 334.00),
  ('P308', 1508.00),
  ('P309', 426.00),
  ('P314', 220.00),
  ('P328', 403.00),
  ('P341', 255.00),
  ('P371', 434.00),
  ('P528', 206.00),
  ('P529', 330.00),
  ('P537', 267.00),
  ('P538', 598.00),
  ('P539', 2038.00),
  ('P541', 718.00),
  ('P550', 7051.00),
  ('P559', 268.00),
  ('P567', 342.00),
  ('P573', 297.00),
  ('P574', 357.00),
  ('P583', 257.00),
  ('P586', 2043.00),
  ('P592', 258.00),
  ('P630', 243.00),
  ('P632', 202.00),
  ('P635', 900.00),
  ('P636', 970.00),
  ('P898', 340.00),
  ('P990', 1624.00),
  ('Q037', 494.00),
  ('Q042', 428.00),
  ('Q172', 407.00),
  ('Q233', 631.00),
  ('Q243', 229.00),
  ('Q252', 280.00),
  ('Q269', 336.00),
  ('Q270', 340.00),
  ('Q302', 229.00),
  ('Q310', 2102.00),
  ('Q311', 1697.00),
  ('Q318', 257.00),
  ('Q399', 2752.00),
  ('Q420', 1042.00),
  ('Q572', 504.00),
  ('Q609', 4467.00),
  ('Q611', 1816.00),
  ('Q805', 454.00),
  ('Q819', 325.00),
  ('Q839', 372.00),
  ('Q925', 367.00),
  ('Q988', 344.00),
  ('R044', 337.00),
  ('R145', 466.00),
  ('R197', 244.00),
  ('R250', 449.00),
  ('R292', 426.00),
  ('R305', 288.00),
  ('R306', 293.00),
  ('R319', 279.00),
  ('R395', 383.00),
  ('R457', 268.00),
  ('R524', 849.00),
  ('R547', 553.00),
  ('R574', 268.00),
  ('R594', 924.00),
  ('R730', 302.00),
  ('R790', 271.00),
  ('R792', 268.00),
  ('R846', 360.00),
  ('R933', 702.00),
  ('S092', 360.00),
  ('S283', 257.00),
  ('S359', 462.00),
  ('S370', 360.00),
  ('S402', 479.00),
  ('S531', 412.00),
  ('S578', 239.00),
  ('S615', 332.00),
  ('S809', 147.00),
  ('S829', 546.00),
  ('S988', 367.00),
  ('S989', 385.00),
  ('T019', 428.00),
  ('T270', 458.00),
  ('T379', 514.00),
  ('T430', 618.00),
  ('T461', 492.00),
  ('T622', 1060.00),
  ('T627', 4028.00),
  ('T974', 271.00),
  ('U035', 439.00),
  ('U293', 407.00),
  ('U445', 268.00),
  ('U450', 1207.00),
  ('U451', 1387.00),
  ('U563', 1449.00),
  ('U903', 345.00),
  ('V160', 626.00),
  ('V199', 376.00),
  ('V469', 1661.00),
  ('V470', 1918.00),
  ('W181', 345.00),
  ('W656', 243.00),
  ('W832', 567.00),
  ('X022', 515.00),
  ('X521', 530.00),
  ('X522', 600.00),
  ('X556', 520.00),
  ('X592', 172.00),
  ('X593', 192.00),
  ('X594', 280.00),
  ('X616', 400.00),
  ('X625', 1207.00),
  ('X862', 428.00),
  ('X874', 1036.00),
  ('X875', 589.00),
  ('X876', 515.00),
  ('X902', 439.00),
  ('X903', 407.00),
  ('X952', 780.00),
  ('X998', 458.00),
  ('Y317', 300.00),
  ('Y365', 259.00),
  ('Y399', 445.00),
  ('Y458', 700.00),
  ('Y517', 300.00),
  ('Y524', 424.00),
  ('Y527', 646.00),
  ('Y560', 462.00),
  ('Y586', 544.00),
  ('Y587', 646.00),
  ('Y601', 300.00),
  ('Y615', 270.00),
  ('Y756', 380.00),
  ('Y757', 380.00),
  ('Y758', 380.00),
  ('Y810', 400.00),
  ('Y820', 1387.00),
  ('Y877', 589.00),
  ('Y939', 295.00)
) AS v(sku, precio)
WHERE medicamentos.sku = v.sku AND medicamentos.precio IS DISTINCT FROM v.precio;

-- Step 2: Update ALL movimientos precio_unitario to match medicamentos.precio
UPDATE movimientos_inventario mi
SET precio_unitario = m.precio
FROM medicamentos m
WHERE m.sku = mi.sku
AND mi.precio_unitario IS DISTINCT FROM m.precio;
